mutation CreatePublicList($name: String!, $description: String)
@auth(level: PUBLIC, insecureReason: "This mutation is safe to expose to the public") {
  list_insert(
    data: {
      name: $name
      description: $description
      public: true
      createdAt_expr: "request.time"
      updatedAt_expr: "request.time"
      userId_expr: "uuidV4()" # Generating a random UUID for public lists, consider more secure alternatives if needed
    }
  )
}

query GetPublicLists
@auth(level: PUBLIC, insecureReason: "This operation is safe to expose to the public") {
  lists(where: { public: { eq: true } }) {
    id
    name
    description
    createdAt
    updatedAt
  }
}

mutation AddMovieToList($listId: UUID!, $movieId: UUID!, $note: String, $position: Int!)
@auth(level: USER, insecureReason: "This mutation allows users to add movies to lists") {
  listMovie_insert(data: { listId: $listId, movieId: $movieId, note: $note, position: $position })
}

query GetUserWatchList($userId: UUID!) @auth(level: USER, insecureReason: "This query allows users to get watch lists") {
  watches(where: { userId: { eq: $userId } }) {
    id
    movie {
      id
      title
      year
    }
    watchDate
  }
}
